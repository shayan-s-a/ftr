<apex:page id="pgOpportunity" tabstyle="Opportunity" standardcontroller="Opportunity" extensions="Opportunity_Controller"
    action="{!retrieveAccountDetails}" doctype="html-5.0" applyBodyTag="true" lightningStylesheets="true" >
    <apex:slds rendered="true" />
    <style type="text/css">
        .custPopup1 {
            background-color: white;
            border-width: 2px;
            border-style: solid;
            z-index: 9999;
            left: 50%;
            padding: 10px;
            position: absolute;
            /* These are the 3 css properties you will need to change so the popup
        displays in the center of the screen. First set the width. Then set
        margin-left to negative half of what the width is. You can add
        the height property for a fixed size pop up if you want.*/
            width: 500px;
            margin-left: -250px;
            position: fixed;
            top: 20%;
        }

        .custPopup2 {
            background-color: white;
            border-width: 2px;
            border-style: solid;
            z-index: 9999;
            left: 50%;
            padding: 10px;
            position: absolute;
            /* These are the 3 css properties you will need to change so the popup
        displays in the center of the screen. First set the width. Then set
        margin-left to negative half of what the width is. You can add
        the height property for a fixed size pop up if you want.*/
            width: 500px;
            margin-left: -250px;
            top: 400px;
        }

        .popupBackground1 {
            background-color: black;
            opacity: 0.20;
            filter: alpha(opacity=20);
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 9998;
        }
    </style>

    <style>
        .display_false {
            display: none;
        }

        #close {
            //padding:1px;
            border: 1.5px solid DarkGray;
            background-color: WhiteSmoke; //border-radius:1.5px;
            font-weight: bold;
            font-size: 95%;
            border-bottom: 1px solid grey;
            -moz-box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.5);
            -webkit-box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.5);
            box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.5);
            cursor: pointer;
            height: 23.5px;
        }

        .approved {
            background-color: #A1F78D !important;
        }

        .rejected {
            background-color: #FB8A8C !important;
        }

        .pending {
            background-color: #FFD74B !important;
        }

        .proposal-button {
            margin-left: -80px !important;
        }

        .generate-button {
            margin-left: -130px !important;
        }


        #blanket,
        #proposal-blanket,
        #generate-blanket,
        #blanketSterling,
        #blanketSFAQuote,
        #schedule-blanket {
            background-color: black;
            opacity: 0.20;
            filter: alpha(opacity=20);
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 9998;
        }

        #popUpDiv,
        #popUpDivSterling,
        #popUpDivSFAQuote {
            background-color: white;
            border: 1px solid grey;
            z-index: 9999;
            left: 50%;
            padding: 20px;
            position: absolute;
            width: 500px;
            margin-left: -250px;
            border-radius: 3px;
        }

        #proposalPopDiv,
        #schedulePopDiv {
            background-color: white;
            border: 1px solid grey;
            z-index: 9999;
            left: 50%;
            padding: 20px;
            position: absolute;
            width: 500px;
            margin-left: -250px;
            border-radius: 3px;
        }

        #generatePopDiv {
            position: absolute;
            background-color: #eeeeee;
            width: 40%;
            height: 140px; //the CRT form portion
            z-index: 22;
        }

        .thLeft {
            text-align: right;
            font-size: 9pt;
            width: 25;
        }

        .alignup {
            vertical-align: top;
        }

        .alignmid {
            vertical-align: middle;
            text-align: right;
        }

        .proposalInfo {
            width: 190%;
            height: 50px;
        }

        .proposalInfo2 {
            width: 245%;
            height: 50px;
        }

        .scheduleInfo1 {
            margin-left: -140px;
            width: 67%;
            height: 15px;
        }

        .scheduleInfo2 {
            margin-left: 0px;
            width: 67%;
            height: 15px;
        }

        .proposal-label {
            width: 200%;
            height: 15px;
        }

        .schedule-label {
            width: 200%;
        }

        #datePicker {
            z-index: 10000;
        }

        .custPopup {
            background-color: white;
            border-width: 2px;
            border-style: solid;
            z-index: 9999;
            left: 50%;
            padding: 10px;
            position: absolute;
            /* These are the 3 css properties you will need to change so the popup 
        displays in the center of the screen. First set the width. Then set 
        margin-left to negative half of what the width is. You can add 
        the height property for a fixed size pop up if you want.*/
            width: 500px;
            margin-left: 30px;
            top: -445px;
        }

        .popupBackground {
            background-color: black;
            opacity: 0.20;
            filter: alpha(opacity=20);
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 9998;
        }

        .submit-button {
            margin-left: 20px;
            width: 48px;
            height: 23px;
        }
    </style>
    <script type="text/javascript">
        var __sfdcSessionId = '{!GETSESSIONID()}';
    </script>
    <script src="/soap/ajax/28.0/connection.js" type="text/javascript"></script>
    <script src="/soap/ajax/28.0/apex.js" type="text/javascript"></script>
    <script type="text/javascript">
        //jquery$ = jQuery.noConflict();
        j$ = jQuery.noConflict();

        function toggle(div_id, id) {
            var el = document.getElementById(div_id);
            if (el.style.display == 'none') { el.style.display = 'block'; }
            else { el.style.display = 'none'; }
        }

        function toggle(div_id) {
            var el = document.getElementById(div_id);
            if (el.style.display == 'none') { el.style.display = 'block'; }
            else { el.style.display = 'none'; }
        }

        function blanket_size(popUpDivVar, id) {
            if (typeof window.innerWidth != 'undefined') {
                viewportheight = window.innerHeight;
            } else {
                viewportheight = document.documentElement.clientHeight;
            }
            if ((viewportheight > document.body.parentNode.scrollHeight) && (viewportheight > document.body.parentNode.clientHeight)) {
                blanket_height = viewportheight;
            } else {
                if (document.body.parentNode.clientHeight > document.body.parentNode.scrollHeight) {
                    blanket_height = document.body.parentNode.clientHeight;
                } else {
                    blanket_height = document.body.parentNode.scrollHeight;
                }
            }
            var blanket = document.getElementById('blanket');

            blanket.style.height = '110%'; //the background portion  
            // blanket.style.height = blanket_height + 'px';

            var popUpDiv = document.getElementById(popUpDivVar);
            //popUpDiv_height=blanket_height/2-150;//150 is half popups height
            //popUpDiv_height='330px';
            //popUpDiv.style.top =  '400px';

            //blanket.style.top =  '25px';
            blanket.style.position = 'Absolute';
            //popUpDiv.style.top = popUpDiv_height + 'px';
        }

        function blanket_size(popUpDivVar) {
            if (typeof window.innerWidth != 'undefined') {
                viewportheight = window.innerHeight;
            } else {
                viewportheight = document.documentElement.clientHeight;
            }
            if ((viewportheight > document.body.parentNode.scrollHeight) && (viewportheight > document.body.parentNode.clientHeight)) {
                blanket_height = viewportheight;
            } else {
                if (document.body.parentNode.clientHeight > document.body.parentNode.scrollHeight) {
                    blanket_height = document.body.parentNode.clientHeight;
                } else {
                    blanket_height = document.body.parentNode.scrollHeight;
                }
            }
            var blanket = document.getElementById('blanket');
            blanket.style.height = '115%'; //the background portion  
            //blanket.style.height = blanket_height + 'px';

            var popUpDiv = document.getElementById(popUpDivVar);

            //popUpDiv.style.top = top + 'px';
            //blanket.style.top =  '25px';
            //blanket.style.left = '30%';
            blanket.style.position = 'Absolute';
            //popUpDiv.style.top = popUpDiv_height + 'px';
        }

        function window_pos(popUpDivVar, id) {
            if (typeof window.innerWidth != 'undefined') {
                viewportwidth = window.innerHeight;
            } else {
                viewportwidth = document.documentElement.clientHeight;
            }
            if ((viewportwidth > document.body.parentNode.scrollWidth) && (viewportwidth > document.body.parentNode.clientWidth)) {
                window_width = viewportwidth;
            } else {
                if (document.body.parentNode.clientWidth > document.body.parentNode.scrollWidth) {
                    window_width = document.body.parentNode.clientWidth;
                } else {
                    window_width = document.body.parentNode.scrollWidth;
                }
            }

            var popUpDivSFAQuote = document.getElementById(popUpDivSFAQuote);
            window_width = window_width / 2 - 150;//150 is half popups width
            popUpDivSFAQuote.style.left = '16%';

            //popUpDiv.style.left = window_width + 'px';
        }

        function window_pos(popUpDivVar) {

            var dualScreenTop = window.screenTop != undefined ? window.screenTop : screen.top;
            var height = window.innerHeight ? window.innerHeight : document.documentElement.clientHeight ? document.documentElement.clientHeight : screen.height;
            //var top = ((height / 2) - (300)) + window.scrollY + dualScreenTop; //Assuming 300 is popup window height as its dynamic and defined as a static value.

            var popUpDiv = document.getElementById(popUpDivVar);
            //popUpDiv.style.top = top + 'px';
            popUpDiv.style.top = '10px';

            if (typeof window.innerWidth != 'undefined') {
                viewportwidth = window.innerHeight;
            } else {
                viewportwidth = document.documentElement.clientHeight;
            }
            if ((viewportwidth > document.body.parentNode.scrollWidth) && (viewportwidth > document.body.parentNode.clientWidth)) {
                window_width = viewportwidth;
            } else {
                if (document.body.parentNode.clientWidth > document.body.parentNode.scrollWidth) {
                    window_width = document.body.parentNode.clientWidth;
                } else {
                    window_width = document.body.parentNode.scrollWidth;
                }
            }
            window_width = window_width / 2 - 150;//150 is half popups width
            //popUpDiv.style.left = window_width + 'px';
        }

        function popup(windowname, id, icb) {
            if (icb == 'true') {
                //updateSterlingQuote(id);
                setCurrentProduct(id);
                blanket_size(windowname, id);
                window_pos(windowname, id);
                toggle('blanket', id);
                toggle(windowname, id);
                //alert(windowname);
                return false;
            }
            else {
                updateSterlingQuotewithoutpopup(id);
            }
        }

        function popupSterling(windowname, id) {

            //updateSterlingQuote(id);
            blanket_size(windowname, id);
            window_pos(windowname, id);
            toggle('blanketSterling', id);
            toggle(windowname, id);
            //window.open(windowname,'_blank');

            return false;
        }

        function popupSFAQuote(windowname, id) {
            //updateSterlingQuote(id);
            blanket_size(windowname, id);
            window_pos(windowname, id);
            toggle('blanketSFAQuote', id);
            toggle(windowname, id);

            return false;
        }

        function submitForApproval(id) {
            submitforapproval(id);
        }

        function proposalpopup(windowname) {
            alert(windowname);
            blanket_size(windowname);
            alert('111111111');
            window_pos(windowname);
            alert('2222');
            toggle('blanket');
            alert('333333333');
            toggle(windowname);
            alert('44444');
            return false;
        }

        //Giri 23/04/2014 Start
        function schedulepopup(windowname) {
            if ({!IsContractExistForAccount
        } == false) {
            blanket_size(windowname);
            window_pos(windowname);
            toggle('generate-blanket');
            toggle(windowname);
            return false;
        }
        else {
            return true;
        }       
    }
        //Giri 23/04/2014 End.
        function SycnUnSyncDeleteClick(oper, Quoteid) {
            if (oper == 'Sync') {
                actionSycnClick(Quoteid);
            }
            if (oper == 'UnSync') {
                actionUnSycnClick(Quoteid);
            }
            if (oper == 'QuoteDel') {
                actionQuoteDeleteClick(Quoteid);
            }
            return false;
        }

        function handleVlocityQuoteAction(action, quoteId) {
            if (action == 'Delete')
                actionDeleteVlocityQuote(quoteId);
            else if (action == 'Sync')
                actionSyncVlocityQuote(quoteId);
            else if (action == 'UnSync')
                actionUnSyncVlocityQuote(quoteId);
            return false;
        }

        function productDeleteClick(Record_Type, Quoteid) {
            alert(Record_Type);
            if (Record_Type == 'SFA') {
                actionProductDeleteClick(Quoteid);
                return false;
            }
            else if (Record_Type == 'Sterling Line Item') {
                actionProductDeleteClick(Quoteid);
                return true;
            }
        }


        function selectSecondElement() {
            var elem = document.getElementById("{!$Component.updatearea.popupblock.popupblocksection.popupregion}");
            elem.selectedIndex = "0";
        }

        function submitForApproval(id) {
            submitforapproval(id);
        }

        function checkLimit(limitField, limitCount) {
            var limitNum = 150;
            if (limitField.value.length > limitNum) {
                limitField.value = limitField.value.substring(0, limitNum);
            } else {
                limitCount.value = limitNum - limitField.value.length;
            }
        }
        //------------added-----------
        function openNewTab() {
            var win = window.open("http://sift.corp.ftr.com/", '_blank');
            win.focus();
        }
        j$(".speeddropdown_0").change(function () {
            var tempSelect = j$(".speeddropdown_0")[0];
            alert(tempSelect.val());
        });

    </script>
    <style>
        .opportunityBlock .pbHeader {
            height: 3.5rem;
            padding-left: 15px;
            background: rgb(243, 242, 242);
        }

        body .pbHeader .pbButton:last-child {
            float: right;
            padding-right: 15px;
        }

        .opportunityBlock .pbHeader .mainTitle {
            font-size: 14px;
        }

        .opportunityBlock .bPageBlock.apexDefaultPageBlock {
            padding: 0px;
        }

        .pbButton:last-child input[value="New Qualified Quote"],
        .pbButton:last-child input[value="New SFA Quote"] {
            margin-left: -1px;
            border-bottom-left-radius: 0px;
            border-top-left-radius: 0px;
            border-bottom-right-radius: 0px;
            border-top-right-radius: 0px;
        }

        .pbButton:last-child input[value="New Vlocity Quote"] {
            border-bottom-right-radius: 0px;
            border-top-right-radius: 0px;
        }

        .pbButton:last-child input[value="DIA EasyPass Quote"] {
            margin-left: -1px;
            border-bottom-left-radius: 0px;
            border-top-left-radius: 0px;
        }

        body .pbHeader~.pbBody {
            margin-top: 0px;
        }

        body .headerRow {
            text-transform: unset;
        }

        body .slds-vf-data-table th,
        .slds-vf-scope .slds-vf-data-table th {
            font-weight: 600;
        }

        body .list>thead>tr>th,
        body .list>tbody>tr>td {
            padding: 7px 10px;
            font-size: 12px;
        }
        body.slds-scope  .pbBody {
            overflow: unset;
        }
        .slds-scope .slds-checkbox [type=checkbox][disabled]+.slds-checkbox--faux {
            background: white;
        }
        [data-component-id="flexipage_visualforcePage"] .slds-card.slds-card_boundary {
            border: unset;
        }

    </style>
    <div class="slds-scope">
        <apex:form id="frmOpportunity">
            <apex:pageblock title="Quotes ({!lstStrQuote.size})" id="quoteListpb">
                <apex:pageblockbuttons location="top">
             <!--       <apex:commandbutton value="DIA Bundle Quote" action="{!launchBundleQuoteOmniscript}" />
                    <apex:commandbutton value="New Vlocity Quote" action="{!launchQuoteOmniscript}" rendered="{!$Profile.Name != 'Frontier Partner Portal User'}"/>
                    <apex:commandbutton rendered="{!AND(VZ3_CPQ_Disabled, Opportunity.Opportunity_Type__c != 'Renewal', $Profile.Name != 'Partner Community User', $Profile.Name != 'Frontier Partner Portal User')}"
                        value="New Qualified Quote" onclick="return popupSterling('popUpDivSterling', null)" />
                    <apex:commandbutton rendered="{!AND(VZ3_CPQ_Disabled, Opportunity.Opportunity_Type__c == 'Renewal', $Profile.Name != 'Partner Community User', $Profile.Name != 'Frontier Partner Portal User')}"
                        value="New Qualified Quote" action="{!reDirectToSterling}"/>
              --> 
                    <!--Frontier Partner Portal User-->
                    <apex:commandbutton rendered="{!AND(VZ3_CPQ_Disabled, Opportunity.Opportunity_Type__c != 'Renewal', $Profile.Name == 'Frontier Partner Portal User', Opportunity.RecordType.Name != 'Opportunity Lightning')}"
                        value="New Qualified Quote" onclick="return popupSterling('popUpDivSterling', null)" />
                    <apex:commandbutton rendered="{!AND(VZ3_CPQ_Disabled, Opportunity.Opportunity_Type__c == 'Renewal', $Profile.Name == 'Frontier Partner Portal User', Opportunity.RecordType.Name != 'Opportunity Lightning')}"
                        value="New Qualified Quote" action="{!reDirectToSterling}"/>
                    <!----------> 
                    
                    
                <!-- <apex:commandbutton value="New SFA Quote" onclick="return popupSterling('popUpDivSFAQuote', null)" rendered="{!AND($Profile.Name == 'Frontier Partner Portal User', Opportunity.RecordType.Name != 'Opportunity Lightning')}"/> -->
                    <apex:commandbutton value="New SFA Quote" onclick="return popupSterling('popUpDivSFAQuote', null)" rendered="{!$Profile.Name != 'Frontier Partner Portal User'}"/>
                  <!--  <apex:commandButton value="DIA EasyPass Quote" action="{!launchEasyPassQuoteOmniscript}" rendered="{!$Profile.Name != 'Frontier Partner Portal User'}"/> -->
                </apex:pageblockbuttons>
                <apex:outputpanel rendered="{!lstStrQuote.size != 0}">
                    <apex:pageMessages />
                    <apex:actionFunction name="actionSyncVlocityQuote" status="processStatus" action="{!syncVlocityQuote}" rerender="pbSterlingQuote,pbProduct,arrow">
                        <apex:param value="" name="currentVlocityQuoteId" assignTo="{!currentVlocityQuoteId}" />
                    </apex:actionFunction>
                    <apex:actionFunction name="actionUnSyncVlocityQuote" status="processStatus" action="{!unSyncVlocityQuote}" rerender="pbSterlingQuote,pbProduct,arrow">
                        <apex:param value="" name="currentVlocityQuoteId" assignTo="{!currentVlocityQuoteId}" />
                    </apex:actionFunction>
                    <apex:actionFunction name="actionDeleteVlocityQuote" status="processStatus" action="{!deleteVlocityQuote}" rerender="pbSterlingQuote,pbProduct,arrow">
                        <apex:param value="" name="currentVlocityQuoteId" assignTo="{!currentVlocityQuoteId}" />
                    </apex:actionFunction>
                    <apex:actionFunction name="actionSycnClick" status="processStatus" action="{!productSyncClick}" rerender="pbSterlingQuote,pbProduct,arrow">
                        <apex:param value="" name="strQuoteid" assignTo="{!strQuoteid}" />
                    </apex:actionFunction>
                    <apex:actionFunction name="actionUnSycnClick" status="processStatus" action="{!productUnSyncClick}" rerender="pbSterlingQuote,pbProduct,arrow">
                        <apex:param value="" name="strQuoteid" assignTo="{!strQuoteid}" />
                    </apex:actionFunction>
                    <apex:actionFunction name="actionQuoteDeleteClick" status="processStatus" action="{!deletelink}" rerender="pbSterlingQuote,pbProduct,arrow,quoteListpb">
                        <apex:param value="" name="SelectedId" assignTo="{!SelectedId}" />
                    </apex:actionFunction>
                    <apex:pageblocktable value="{!lstStrQuote}" var="sq" id="pbSterlingQuote" rendered="{!lstStrQuote.size != 0}">
                        <apex:column headervalue="Actions">
                            <apex:commandLink title="Edit Quote" action="{!editlinks}" value="Edit" rendered="{!$Profile.Name != 'Frontier Partner Portal User' && ShowEditLinks && sq.RecordTypeName != 'Vlocity'}">
                                <apex:param name="SelectedId" value="{!sq.Id}" assignTo="{!SelectedId}" />
                            </apex:commandLink>
                            <apex:commandLink title="Edit Quote" action="{!editVlocityQuote}" value="Edit" rendered="{!$Profile.Name != 'Frontier Partner Portal User' && sq.RecordTypeName == 'Vlocity'}">
                                <apex:param name="currentVlocityQuoteId" value="{!sq.Id}" assignTo="{!currentVlocityQuoteId}" />
                            </apex:commandLink>
                            
                            <!--rendered="{!$Profile.Name != 'Frontier Partner Portal User'}"-->
                            <apex:commandLink title="Edit Quote" action="{!editlinks}" value="Edit" rendered="{!$Profile.Name == 'Frontier Partner Portal User' && ShowEditLinks && sq.RecordTypeName != 'Vlocity'}" target="_blank">
                                <apex:param name="SelectedId" value="{!sq.Id}" assignTo="{!SelectedId}" />
                            </apex:commandLink>
                            <apex:commandLink title="Edit Quote" action="{!editVlocityQuote}" value="Edit" rendered="{!$Profile.Name == 'Frontier Partner Portal User' && sq.RecordTypeName == 'Vlocity'}" target="_blank">
                                <apex:param name="currentVlocityQuoteId" value="{!sq.Id}" assignTo="{!currentVlocityQuoteId}" />
                            </apex:commandLink>
                            <!----------------------------------------------------------------->
                            
                            <apex:outputtext value=" | " rendered="{!IF(sq.RecordTypeName == 'SFA' || ShowEditLinks,TRUE,FALSE)}" />
                            <apex:commandLink title="Delete Quote" onclick="return SycnUnSyncDeleteClick('QuoteDel','{!sq.Id}');" value="Del" rendered="{!IF(sq.RecordTypeName == 'SFA' || ShowEditLinks,TRUE,FALSE) && sq.RecordTypeName != 'Vlocity'}"
                            />
                            <apex:commandLink title="Delete Quote" onclick="return handleVlocityQuoteAction('Delete','{!sq.Id}');" value="Del" rendered="{!sq.RecordTypeName == 'Vlocity'}"
                            />
                            <apex:outputText value=" | " rendered="{!AND(NOT(sq.IsSyncing),(sq.IsSyncAllowedByAdmin || sq.IsSyncAllowed),ShowEditLinks)}"
                            />
                            <apex:commandLink title="Sync Quote" value="Sync" onclick="return SycnUnSyncDeleteClick('Sync','{!sq.Id}');" rendered="{!NOT(sq.IsSyncing) && (sq.IsSyncAllowedByAdmin || sq.IsSyncAllowed) && sq.RecordTypeName != 'Vlocity'}"
                            />
                            <apex:commandLink title="Sync Quote" value="Sync" onclick="return handleVlocityQuoteAction('Sync','{!sq.Id}');" rendered="{!NOT(sq.IsSyncing) && sq.RecordTypeName == 'Vlocity'}"
                            />
                            <apex:outputText value=" | " rendered="{!(sq.IsSyncing ) }" />
                            <apex:commandLink title="Unsync Quote" value="Unsync" onclick="return SycnUnSyncDeleteClick('UnSync','{!sq.Id}');" rendered="{!sq.IsSyncing  && sq.RecordTypeName != 'Vlocity'}"
                            />
                            <apex:commandLink title="Unsync Quote" value="Unsync" onclick="return handleVlocityQuoteAction('UnSync','{!sq.Id}');" rendered="{!sq.IsSyncing  && sq.RecordTypeName == 'Vlocity'}"
                            />
                        </apex:column>
                        <apex:column headerValue="Name" headerClass="headerRow" rendered="{!sq.RecordTypeName != 'Vlocity'}">
                            <apex:outputLink target="_top" styleClass="actionLink" value="/lightning/r/SterlingQuote__c/{!sq.id}/view" rendered="{!$Profile.Name != 'Frontier Partner Portal User'}">{!sq.Name}</apex:outputLink>
                            <!-- Frontier Partner Portal User 
                            <apex:outputLink target="_blank" styleClass="actionLink" value="/lightning/r/SterlingQuote__c/{!sq.id}/view" rendered="{!$Profile.Name == 'Frontier Partner Portal User'}">{!sq.Name}</apex:outputLink>
                            -->
                            <apex:commandLink title="{!sq.Name}" action="{!openQuoteForPartnerPortal}" value="{!sq.Name}" rendered="{!$Profile.Name == 'Frontier Partner Portal User'}" target="_blank">
                                <apex:param name="currentQuoteId" value="{!sq.Id}" assignTo="{!currentQuoteId}" />
                                <apex:param name="isVelocity" value="False" assignTo="{!isVelocity}" />
                            </apex:commandLink>
                            <!---------------------------------->
                            <span>&nbsp;&nbsp;</span>
                        </apex:column>
                        <apex:column headerValue="Name" headerClass="headerRow" rendered="{!sq.RecordTypeName == 'Vlocity'}">
                            <apex:outputLink target="_top" styleClass="actionLink" value="/lightning/r/Quote/{!sq.id}/view" rendered="{!$Profile.Name != 'Frontier Partner Portal User'}">{!sq.Name}</apex:outputLink>
                            <!-- Frontier Partner Portal User-->
                            <apex:commandLink title="{!sq.Name}" action="{!openQuoteForPartnerPortal}" value="{!sq.Name}" rendered="{!$Profile.Name == 'Frontier Partner Portal User'}" target="_blank">
                                <apex:param name="currentQuoteId" value="{!sq.Id}" assignTo="{!currentQuoteId}" />
                                <apex:param name="isVelocity" value="True" assignTo="{!isVelocity}" />
                            </apex:commandLink>
                            <!---------------------------------->
                            <span>&nbsp;&nbsp;</span>
                        </apex:column>
                        <apex:column headervalue="Synced">
                            <label class="slds-checkbox">
                                <apex:inputcheckbox styleclass="slds-input" value="{! sq.IsSyncing }" disabled="true" />
                                <span class="slds-checkbox--faux"></span>
                            </label>
                        </apex:column>
                        <apex:column value="{!sq.RecordTypeName}" Headervalue="Record Type" />
                    </apex:pageblocktable>
                    <!-- <apex:outputPanel layout="block" styleClass="pSearchShowMore" id="arrow">
                    <apex:image url="/img/search_prevarrow_disabled.gif" styleClass="prevArrow" rendered="{!NOT(hasPrevious)}" />
                    <apex:image url="/img/search_prevarrow.gif" title="Previous Page" styleClass="prevArrow" rendered="{!hasPrevious}" />
                    <apex:commandLink status="fetchStatus" reRender="pbSterlingQuote,arrow" action="{!previous}" title="Previous Page" value="Previous Page"
                        rendered="{!hasPrevious}" />
                    <apex:outputPanel styleClass="pShowLess noLink" style="color:grey" rendered="{!NOT(hasPrevious)}">Previous Page</apex:outputPanel>
                    &nbsp;({!(pageNumber * size)+1-size}-{!IF((pageNumber * size)>noOfRecords, noOfRecords,(pageNumber * size))} of {!noOfRecords})&nbsp;
                    <apex:outputPanel styleClass="pShowLess noLink" style="color:grey" rendered="{!NOT(hasNext)}">Next Page</apex:outputPanel>
                    <apex:commandLink status="fetchStatus" reRender="pbSterlingQuote,arrow" title="Next Page" value="Next Page" rendered="{!hasNext}"
                        action="{!next}" />&nbsp;
                    <apex:image url="/img/search_nextarrow.gif" title="Next Page" styleClass="nextArrow" rendered="{!hasNext}" />
                    <apex:image url="/img/search_nextarrow_disabled.gif" rendered="{!NOT(hasNext)}" />
                </apex:outputPanel> -->
                    <apex:outputPanel layout="block" styleClass="pSearchShowMore" style="color:#4AA02C;font-weight:bold;">
                        <apex:actionStatus id="fetchStatus" startText="Fetching..." stopText="" />
                    </apex:outputPanel>
                </apex:outputPanel>
                <apex:outputpanel rendered="{!lstStrQuote.size == 0}">
                    <table class="list" border="0" cellspacing="0" cellpadding="0" style="margin-left:-6px;margin-right:-15px;">
                        <tbody>
                            <tr class="headerRow">
                                <th scope="col" class="noRowsHeader" style="font-weight:normal;font-size:1em;padding: 20px;">No records to display</th>
                            </tr>
                        </tbody>
                    </table>
                </apex:outputpanel>
                <div style="width: 100%; background: white;border-top:1px solid lightgrey;">
                    <apex:actionStatus id="processStatus">
                        <apex:facet name="start">
                            <apex:image style="padding: 5px;" url="{!URLFOR($Resource.Animation_Loading)}" />
                        </apex:facet>
                    </apex:actionStatus>
                </div>
            </apex:pageblock>

        </apex:form>
        <div id="proposal-blanket" style="display:none;"> </div>
        <div id="proposalPopDiv" style="display:none;">
            <apex:Form >
            </apex:Form>
        </div>
        <apex:form >

            <apex:outputPanel id="tstpopup">
                <apex:outputPanel styleClass="popupBackground1" layout="block" rendered="{!displayPopUp}" />
                <apex:outputPanel styleClass="custPopup1" layout="block" rendered="{!displayPopUp}">
                    <apex:pageBlock title="Information For Proposal" id="popupblockk">
                        <apex:pageblocksection id="popupblocksection0A" rendered="{!NOT(showNoSyncError || showApprovedProductsNonZero)}">
                            <apex:outputText styleClass="proposal-label" value="">Proposal Type:</apex:outputText>
                            <br/>
                        </apex:pageblocksection>
                        <apex:pageblocksection id="popupblocksection0B" rendered="{!NOT(showNoSyncError || showApprovedProductsNonZero)}">
                            <apex:selectList value="{!selectedProposalType}" size="1" required="true">
                                <apex:selectOptions value="{!proposalTypes}" />
                            </apex:selectList>
                        </apex:pageblocksection>
                        <apex:pageblocksection id="popupblocksection1" rendered="{!NOT(showNoSyncError || showApprovedProductsNonZero)}">
                            <apex:outputText styleClass="proposal-label" value="Your Company's current communications capabilities include:" />
                            <br/>
                        </apex:pageblocksection>
                        <apex:pageblocksection id="popupblocksection2" rendered="{!NOT(showNoSyncError || showApprovedProductsNonZero)}">
                            <apex:inputTextArea styleClass="proposalInfo" value="{!proposalCompany}" onkeydown="checkLimit(this,this.form.countdown);"
                                onkeyup="checkLimit(this,this.form.countdown);" onchange="checkLimit(this,this.form.countdown);"
                            />
                            <br/>
                        </apex:pageblocksection>
                        <apex:pageblocksection id="popupblocksection3" rendered="{!NOT(showNoSyncError || showApprovedProductsNonZero)}">
                            <apex:outputText styleClass="proposal-label" value="Your immediate and future communications needs are:" />
                            <br/>
                        </apex:pageblocksection>
                        <apex:pageblocksection id="popupblocksection4" rendered="{!NOT(showNoSyncError || showApprovedProductsNonZero)}">
                            <apex:inputTextArea styleClass="proposalInfo2" value="{!proposalFuture}" onkeydown="checkLimit(this,this.form.countdown);"
                                onkeyup="checkLimit(this,this.form.countdown);" onchange="checkLimit(this,this.form.countdown);"
                            />
                        </apex:pageblocksection>
                        <apex:outputLabel value="A quote needs to be synced to generate proposal" rendered="{!showNoSyncError && NOT(showApprovedProductsNonZero)}"
                        />
                        <apex:outputLabel value="Approval Pending-Product(S) Not Eligible For Proposal At This Time" rendered="{!showApprovedProductsNonZero && NOT(showNoSyncError)}"
                        />
                    </apex:pageBlock>
                    <br/>
                    <br/>
                    <br/> &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;
                    &nbsp;&nbsp;&nbsp;&nbsp;
                    <apex:commandButton value="Generate" styleClass="proposal-button" action="{!generateproposalattachment}" rerender="proposalpopup"
                        rendered="{!NOT(showNoSyncError || showApprovedProductsNonZero)}" />
                    <apex:commandButton value="Close" action="{!closePopup}" rerender="tstpopup" />
                </apex:outputPanel>
            </apex:outputPanel>
        </apex:form>

        <apex:form >
            <apex:outputPanel id="tstpopupQQ">
                <apex:outputPanel styleClass="popupBackground1" layout="block" rendered="{!displayPopUpQQ}" />
                <apex:outputPanel styleClass="custPopup2" layout="block" rendered="{!displayPopUpQQ}">
                    <apex:pageBlock title="" id="popupblockQQ">
                        <apex:pageblocksection id="popupblocksection0AQQ">
                            <apex:outputText styleClass="proposal-label" value="">Quick Quote Type:</apex:outputText>
                            <br/>
                        </apex:pageblocksection>
                        <apex:pageblocksection id="popupblocksection0BQQ">
                            <apex:selectList value="{!selectedQQT}" size="1" required="true">
                                <apex:selectOptions value="{!qqTypes}" />
                            </apex:selectList>
                        </apex:pageblocksection>
                        <apex:pageblocksection id="popupblocksection1QQ">
                            <apex:outputText styleClass="proposal-label" value="">Comments (The comments will be included in the attachment created in Notes and Attachments):</apex:outputText>
                            <br/>
                        </apex:pageblocksection>
                        <apex:pageblocksection id="popupblocksection2QQ">
                            <apex:inputTextArea styleClass="proposalInfo" value="{!commentStr}" onkeydown="checkLimit(this,this.form.countdown);" onkeyup="checkLimit(this,this.form.countdown);"
                                onchange="checkLimit(this,this.form.countdown);" />
                            <br/>
                        </apex:pageblocksection>
                    </apex:pageBlock>
                    <br/>
                    <br/>
                    <br/> &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;
                    &nbsp;&nbsp;&nbsp;&nbsp;
                    <div align="center">
                        <apex:commandButton value="Save" styleClass="proposal-button" action="{!quickQuoteQQ}" rerender="tstpopupQQ" />
                        <apex:commandButton value="Close" action="{!closePopupQQ}" rerender="tstpopupQQ" />
                    </div>
                </apex:outputPanel>
            </apex:outputPanel>
        </apex:form>


        <div id="schedule-blanket" style="display:none;"> </div>
        <div id="schedulePopDiv" style="display:none;">
            <apex:Form >
            </apex:Form>
        </div>


        <div id="blanket" style="display:none;"> </div>
        <div id="popUpDiv" style="display:none;">

            <!-- MGG319 Remove popup for ICB Processes -->
            <apex:form id="updatearea">
                <apex:pageMessages />
                <apex:pageBlock title="Discount Pricing Request" id="popupblock" mode="maindetail">
                    <apex:pageblockSection columns="1" id="popupblocksection">
                        <apex:inputField value="{!objSterlingQuoteItem.ICB_Request__c}" label="ICB/BDT Request #" />

                        <apex:inputField value="{!objSterlingQuoteItem.SIFT_Number__c}" label="SIFT #" />
                    </apex:pageBlockSection>
                </apex:pageBlock>

                <div style="margin-right:20px;">
                    <apex:commandButton styleClass="submit-button" value="Submit" rerender="updatearea" action="{!SubmitForICB}">
                        <apex:param name="param" value="" id="x" assignTo="{!currentProduct}"></apex:param>
                    </apex:commandButton>
                    <apex:commandButton id="close" value="Cancel" onclick="popup('popUpDiv', null,null)" />
                </div>
            </apex:form>
        </div>

        <div id="blanketSterling" style="display:none;"> </div>
        <div id="popUpDivSterling" style="display:none;">
            <apex:form >
                <apex:pageBlock >
                    <apex:pageBlockSection title="List of Addresses" id="custinfo" columns="1" rendered="{!displayAddressGrid}">
                        <tr>
                            <apex:pageblockTable value="{!addressinfo}" var="varVal">
                                <apex:column value="{!varVal.strColumnOne}" headerValue="Address Info" headerClass="TableTitle" style="font-weight: bold;"
                                    Width="200px" />
                                <apex:column value="{!varVal.strColumnTwo}" headerValue="" headerClass="TableTitle" Width="250px" />
                            </apex:pageblocktable>
                        </tr>
                    </apex:pageBlockSection>
                </apex:pageBlock>
                <center>
                    <span>Select an address from below dropdown</span>
                    <br/>
                    <br/>
                    <apex:selectList value="{!defaultAddress}" size="1">
                        <apex:selectOptions value="{!dynamicOptions}" />
                    </apex:selectList>
                    <br/>
                    <br/>
                   <!-- <apex:commandlink  target="_blank"> -->
                    <apex:commandButton value="Submit" action="{!reDirectToSterling}" />
                   <!--  </apex:commandLink> -->
                    
                    <apex:commandButton id="close" value="Cancel" onclick="popupSterling('popUpDivSterling', null)"/>
                   
                </center>
            </apex:form>
        </div>

        <div id="blanketSFAQuote" style="display:none;"> </div>
        <div id="popUpDivSFAQuote" style="display:none;">
            <apex:form >
                <apex:pageBlock >
                    <apex:pageBlockSection title="List of SFA Addresses" id="custinfo" columns="1" rendered="{!displayAddressGrid}">
                        <tr>
                            <apex:pageblockTable value="{!addressinfo}" var="varVal">
                                <apex:column value="{!varVal.strColumnOne}" headerValue="Address Info" headerClass="TableTitle" style="font-weight: bold;"
                                    Width="200px" />
                                <apex:column value="{!varVal.strColumnTwo}" headerValue="" headerClass="TableTitle" Width="250px" />
                            </apex:pageblocktable>
                        </tr>
                    </apex:pageBlockSection>
                </apex:pageBlock>
                <center>
                    <span>Select an address from below dropdown</span>
                    <br/>
                    <br/>
                    <apex:selectList value="{!defaultAddress}" size="1">
                        <apex:selectOptions value="{!dynamicOptions}" />
                    </apex:selectList>
                    <br/>
                    <br/>
                    <apex:commandButton value="Submit" action="{!reDirectToSFAQuote}" />
                    <apex:commandButton id="close" value="Cancel" onclick="popupSterling('popUpDivSFAQuote', null)" />
                </center>
            </apex:form>
        </div>

        <div id="generate-blanket" style="display:none; top:600px margin-left:-1.5%;"> </div>
        <div id="generatePopDiv" style="display:none; left:2px">
            <apex:Form >
                <apex:outputPanel id="generatePopup">
                    <apex:outputPanel styleClass="popupBackground" layout="block" />
                    <!-- rendered="{!displayPopUp}" -->
                    <apex:outputPanel id="popupGenerateformpanel" styleClass="custPopup" layout="block">
                        <!-- rendered="{!displayPopUp}" -->
                        <apex:pageBlock title="Information For Schedule" id="popupblockk">
                            <apex:outputLabel value="You should create a Contract to your account in order to generate a schedule" />
                        </apex:pageBlock>
                        <div style="padding-left:23em;">
                            <input type="button" class="btn" value="Generate Contract" Class="generate-button" onclick="window.open('{!URLFOR($Action.Contract.New,null,[ctrc7=objOpp.Account.Name,ctrc7_lkid=objOpp.AccountId,ctrc5=dtToday],false)}','_blank');schedulepopup('generatePopDiv');"
                            /> &nbsp;&nbsp;&nbsp;&nbsp;
                            <input id="close" class="btn" type="button" value="Close" onclick="schedulepopup('generatePopDiv');" />
                        </div>
                    </apex:outputPanel>
                </apex:outputPanel>
            </apex:Form>
        </div>
    </div>
    <style type="text/css">
        .docusigncustpopup {
            background-color: white;
            border-width: 2px;
            border-style: solid;
            z-index: 9999;
            left: 50%;
            padding: 10px;
            position: absolute;
            /* These are the 3 css properties you will need to change so the popup 
            displays in the center of the screen. First set the width. Then set 
            margin-left to negative half of what the width is. You can add 
            the height property for a fixed size pop up if you want.*/
            width: 500px;
            margin-left: -250px;
            top: 100px;
        }

        .docusignBackGround {
            background-color: black;
            opacity: 0.20;
            filter: alpha(opacity=20);
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 9998;
        }
    </style>
</apex:page>