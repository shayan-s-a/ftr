<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <actionCalls>
        <name>Check_Oppty_Locked_or_Not</name>
        <label>Check Oppty Locked or Not</label>
        <locationX>1364</locationX>
        <locationY>1139</locationY>
        <actionName>OpportunityUtility</actionName>
        <actionType>apex</actionType>
        <connector>
            <targetReference>Is_Order_BDT_Number_filled</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>opptyList</name>
            <value>
                <elementReference>$Record.Opportunity.Id</elementReference>
            </value>
        </inputParameters>
        <nameSegment>OpportunityUtility</nameSegment>
        <outputParameters>
            <assignToReference>LockedYesOrNo</assignToReference>
            <name>output</name>
        </outputParameters>
        <versionSegment>1</versionSegment>
    </actionCalls>
    <actionCalls>
        <name>PM_Survey</name>
        <label>PM Survey</label>
        <locationX>50</locationX>
        <locationY>1139</locationY>
        <actionName>nps_pm_order_experience_assessment</actionName>
        <actionType>dynamicSendSurveyInvitation</actionType>
        <connector>
            <targetReference>Update_Acct_Last_PM_Survey_Sent_date</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>recipientType</name>
            <value>
                <stringValue>Contact</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>recipient</name>
            <value>
                <stringValue>{!$Record.Technical_Contact__r.Id}</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>surveySubjectEntity</name>
            <value>
                <stringValue>{!$Record.Id}</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>personalInvitation</name>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>isUnauthenticatedResponse</name>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>autoExpiryDays</name>
            <value>
                <numberValue>14.0</numberValue>
            </value>
        </inputParameters>
        <nameSegment>nps_pm_order_experience_assessment</nameSegment>
        <versionSegment>1</versionSegment>
    </actionCalls>
    <apiVersion>57.0</apiVersion>
    <assignments>
        <name>Set_Risk_Case_1</name>
        <label>Set Risk Case 1</label>
        <locationX>465</locationX>
        <locationY>647</locationY>
        <assignmentItems>
            <assignToReference>NewCase.Origin</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Automatically Created</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>NewCase.Reason_At_Risk__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Business/Location Closure</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>NewCase.AccountId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.AccountId</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>NewCase.ContactId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Order_Contact__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>NewCase.Orderz__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>NewCase.RecordTypeId</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>0120h000000kwjjAAA</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>NewCase.Subject</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>forNewCaseSubject</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>NewCase.OwnerId</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>00G8a000003DrlF</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Is_Order_Complete</targetReference>
        </connector>
    </assignments>
    <decisions>
        <name>Is_CNP_Active</name>
        <label>Is CNP Active?</label>
        <locationX>710</locationX>
        <locationY>2471</locationY>
        <defaultConnector>
            <targetReference>Create_Order_Management_Task_2</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>YesCNPActive</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_CNP_from_Acct_Team.User.IsActive</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Update_CNP</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Is_CNP_Found</name>
        <label>Is CNP Found?</label>
        <locationX>908</locationX>
        <locationY>2363</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>CNP_Found</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_CNP_from_Acct_Team</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Is_CNP_Active</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Is_CNP_update_necessary</name>
        <label>Is CNP update necessary?</label>
        <locationX>1095</locationX>
        <locationY>2147</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>CNP_Update_Necessary</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Order_Provisioner__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_CNP_from_Acct_Team</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Is_created_only</name>
        <label>Is New Order?</label>
        <locationX>751</locationX>
        <locationY>323</locationY>
        <defaultConnector>
            <targetReference>Is_Order_Complete</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>YesCreatedOnly</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>VarIsInsert</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Update_with_pulling_AE_Info</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Is_Impl_Update_Necessary</name>
        <label>Is Master Agent?</label>
        <locationX>1095</locationX>
        <locationY>1847</locationY>
        <defaultConnector>
            <targetReference>Is_CNP_update_necessary</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>X205_Master_Agent</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Sales_Channel__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Sales_Channel__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>205 - Master Agents</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Sales_Channel__c</leftValueReference>
                <operator>IsChanged</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Add_Order_Management_Task_3</targetReference>
            </connector>
            <label>205 - Master Agent</label>
        </rules>
    </decisions>
    <decisions>
        <name>Is_Opportunity_BDT_Number_filled</name>
        <label>Is Opportunity BDT Number filled?</label>
        <locationX>1320</locationX>
        <locationY>1031</locationY>
        <defaultConnector>
            <targetReference>Is_the_IS_CNP_Auto_Assignment_Condition_Met</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Oppty_BDT_Number_is_filled</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Opportunity.BDT_Number__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Update_BDT</targetReference>
            </connector>
            <label>Oppty BDT Number is filled</label>
        </rules>
        <rules>
            <name>Oppty_BDT_not_filled_and_Oppty_associated</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.OpportunityId</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Opportunity.BDT_Number__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Check_Oppty_Locked_or_Not</targetReference>
            </connector>
            <label>Oppty BDT not filled and Oppty associated</label>
        </rules>
    </decisions>
    <decisions>
        <name>Is_Order_BDT_Number_filled</name>
        <label>Is Order BDT Number filled?</label>
        <locationX>1364</locationX>
        <locationY>1247</locationY>
        <defaultConnector>
            <targetReference>Is_the_IS_CNP_Auto_Assignment_Condition_Met</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Order_BDT_Number_is_filled</name>
            <conditionLogic>1 AND ( 2 OR 3 ) AND 4</conditionLogic>
            <conditions>
                <leftValueReference>$Record.BDT__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$User.Edit_135_Day_Old_Oppty__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>varToday</leftValueReference>
                <operator>LessThan</operator>
                <rightValue>
                    <elementReference>varOpptyEditExpirationDate</elementReference>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>LockedYesOrNo</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>No</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Update_Oppty_Rec</targetReference>
            </connector>
            <label>Order BDT Number is filled</label>
        </rules>
    </decisions>
    <decisions>
        <name>Is_Order_Complete</name>
        <label>Is Order Complete?</label>
        <locationX>751</locationX>
        <locationY>923</locationY>
        <defaultConnector>
            <targetReference>Is_Opportunity_BDT_Number_filled</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>YesOrderComplete</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Order_Stage__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Complete</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Order_Stage__c</leftValueReference>
                <operator>IsChanged</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Tech_Contact_Exists</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Is_Risk_Case_Needed</name>
        <label>Is Risk Case Needed?</label>
        <locationX>597</locationX>
        <locationY>539</locationY>
        <defaultConnector>
            <targetReference>Is_Order_Complete</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Risk_Case_is_Needed</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>$Record.RecordType.Name</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>UCaaS Disconnect Order</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.RecordType.Name</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Circuit Disconnect</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.RecordType.Name</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Voice Disconnect Order</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.RecordType.Name</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>FAW Mitel Disconnect Order</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.RecordType.Name</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Disconnect Order</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_Risk_Case_1</targetReference>
            </connector>
            <label>Risk Case is Needed</label>
        </rules>
    </decisions>
    <decisions>
        <name>Is_the_IS_CNP_Auto_Assignment_Condition_Met</name>
        <label>Is the CNP Auto Assignment Condition Met?</label>
        <locationX>1320</locationX>
        <locationY>1631</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>IS_CNP_Auto_Assignment_Condition_Met</name>
            <conditionLogic>(1 OR 2 OR 3 OR 4) AND (5 OR 6 OR 7) AND 8</conditionLogic>
            <conditions>
                <leftValueReference>$Record.RecordType.Name</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Move Order</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.RecordType.Name</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>New Order</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.RecordType.Name</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Upgrade/Downgrade Order</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.RecordType.Name</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Vlocity OM Order</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Product_Type__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Ethernet</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Product_Type__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Managed Enterprise WiFi</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Product_Type__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Managed Services</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Order_Provisioner__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_Order_Management_Queue</targetReference>
            </connector>
            <label>IS/CNP Auto Assignment Condition Met</label>
        </rules>
    </decisions>
    <decisions>
        <name>MoreConditions</name>
        <label>MoreConditions</label>
        <locationX>182</locationX>
        <locationY>1439</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>FreeMonthsCampaign</name>
            <conditionLogic>(1 AND (2 OR 3)) OR (4 AND (5 OR 6)) AND (7 OR 8)</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Opportunity.CampaignId</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Opportunity.Campaign.Name</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>New logo, free months pilot</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Opportunity.Campaign.Name</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Disruptive Offer Pilot Phase 2.0</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Opportunity.Secondary_Campaign_Name__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Opportunity.Secondary_Campaign_Name__r.Name</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>New logo, free months pilot</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Opportunity.Secondary_Campaign_Name__r.Name</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Disruptive Offer Pilot Phase 2.0</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Product__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Managed Network Services</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Product__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>EIA</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_Centralized_Services_queue</targetReference>
            </connector>
            <label>FreeMonthsCampaign</label>
        </rules>
    </decisions>
    <decisions>
        <name>Tech_Contact_Exists</name>
        <label>Tech Contact Exists</label>
        <locationX>182</locationX>
        <locationY>1031</locationY>
        <defaultConnector>
            <targetReference>MoreConditions</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Yes_TechContact</name>
            <conditionLogic>1 AND 2 AND (3 OR 4 OR 5 OR 6 OR 7 OR 8 OR 9 OR 10 OR 11 OR 12) AND 13</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Technical_Contact__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Network_Project_Specialist__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Record_Type_Ids__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Vlocity OM Order</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Record_Type_Ids__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Circuit Move Order</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Record_Type_Ids__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Frontier Direct Calling</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Record_Type_Ids__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Manual Vlocity Order</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Record_Type_Ids__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Move Order</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Record_Type_Ids__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>New Order</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Record_Type_Ids__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Change Order</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Record_Type_Ids__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Upgrade/Downgrade Order</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Record_Type_Ids__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>UCaaS New Order</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Record_Type_Ids__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Circuit New Order</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Account.Last_PM_Survey_Sent__c</leftValueReference>
                <operator>LessThanOrEqualTo</operator>
                <rightValue>
                    <elementReference>varTodayMinus30</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>PM_Survey</targetReference>
            </connector>
            <label>Yes_TechContact</label>
        </rules>
    </decisions>
    <description>Risk Case Automations removed + PM Survey + Remove auto assignments of IS + Updated for Retention Queue + Last PM Survey Date updated
V15-Removal of BPO assignment for Order stage = Network COE</description>
    <environments>Default</environments>
    <formulas>
        <name>AEName</name>
        <dataType>String</dataType>
        <expression>{!$Record.Opportunity.Owner.FirstName}&amp;&apos; &apos;&amp;{!$Record.Opportunity.Owner.LastName}</expression>
    </formulas>
    <formulas>
        <name>CurrentOrderURL</name>
        <dataType>String</dataType>
        <expression>LEFT($Api.Enterprise_Server_URL_510, FIND( &apos;/services&apos;, $Api.Enterprise_Server_URL_510)) &amp; {!$Record.Id}</expression>
    </formulas>
    <formulas>
        <name>forNewCaseSubject</name>
        <dataType>String</dataType>
        <expression>&quot;Auto Generated Risk Case per order# &quot;+{!$Record.OrderNumber}</expression>
    </formulas>
    <formulas>
        <name>NextBusinessDay</name>
        <dataType>Date</dataType>
        <expression>{!$Flow.CurrentDate} + 
 CASE( 
  WEEKDAY({!$Flow.CurrentDate}), 
   1, 1,
   2, 1,
   3, 1,
   4, 1,
   5, 1,
   6, 3,
   7, 2,
 0)</expression>
    </formulas>
    <formulas>
        <name>RecordURL</name>
        <dataType>String</dataType>
        <expression>LEFT($Api.Partner_Server_URL_340, FIND( &apos;/services&apos;, $Api.Partner_Server_URL_340)) &amp; {!$Record.Opportunity.Id}</expression>
    </formulas>
    <formulas>
        <name>varCurrentOrderURL</name>
        <dataType>String</dataType>
        <expression>LEFT($Api.Enterprise_Server_URL_510, FIND( &apos;/services&apos;, $Api.Enterprise_Server_URL_510)) &amp; {!$Record.Id}</expression>
    </formulas>
    <formulas>
        <name>varForDate</name>
        <dataType>Date</dataType>
        <expression>TODAY()+1</expression>
    </formulas>
    <formulas>
        <name>VarIsInsert</name>
        <dataType>Boolean</dataType>
        <expression>ISNEW()</expression>
    </formulas>
    <formulas>
        <name>varIsValidRecTypes</name>
        <dataType>Boolean</dataType>
        <expression>NOT(OR(
  {!varRecordTypeName} = &apos;ucaas change order&apos;,
  {!varRecordTypeName} = &apos;UCaaS Contract Renewal Order&apos;,
  {!varRecordTypeName} = &apos;UCaaS Disconnect Order&apos;,
  {!varRecordTypeName} = &apos;UCaaS Move Order&apos;,
  {!varRecordTypeName} = &apos;UCaaS New Order&apos;,
  {!varRecordTypeName} = &apos;UCaaS Records Only Order&apos;,
  {!varRecordTypeName} = &apos;UCaaS Transfer of Ownership Ord&apos;,
  {!varRecordTypeName} = &apos;FAW Mitel Change Order&apos;,
  {!varRecordTypeName} = &apos;FAW Mitel Disconnect Order&apos;,
  {!varRecordTypeName} = &apos;Frontier Direct Calling&apos;
))</expression>
    </formulas>
    <formulas>
        <name>varOpptyEditExpirationDate</name>
        <dataType>Date</dataType>
        <expression>IF(ISBLANK({!$Record.Opportunity.Mgr_Signed_Date__c}), TODAY(), {!$Record.Opportunity.Mgr_Signed_Date__c})+135</expression>
    </formulas>
    <formulas>
        <name>varRecordTypeName</name>
        <dataType>String</dataType>
        <expression>{!$Record.RecordType.Name}</expression>
    </formulas>
    <formulas>
        <name>varReviewTaskSubject</name>
        <dataType>String</dataType>
        <expression>{!$Record.OrderNumber} &amp; &quot;: Review assignment&quot;</expression>
    </formulas>
    <formulas>
        <name>varTaskCNPSubject</name>
        <dataType>String</dataType>
        <expression>{!$Record.OrderNumber}  &amp; &quot;: CNP &quot; &amp; {!Get_CNP_from_Acct_Team.User.Name} &amp; &quot; is INACTIVE or on PTO&quot;</expression>
    </formulas>
    <formulas>
        <name>varToday</name>
        <dataType>Date</dataType>
        <expression>TODAY()</expression>
    </formulas>
    <formulas>
        <name>varTodayMinus30</name>
        <dataType>Date</dataType>
        <expression>TODAY()-30</expression>
    </formulas>
    <interviewLabel>Order: On Create and Update {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Order: On Create and Update</label>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>AUTO_LAYOUT_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>AutoLaunchedFlow</processType>
    <recordCreates>
        <name>Add_Order_Management_Task_3</name>
        <label>Add Order Management Task</label>
        <locationX>963</locationX>
        <locationY>1955</locationY>
        <connector>
            <targetReference>Is_CNP_update_necessary</targetReference>
        </connector>
        <inputAssignments>
            <field>ActivityDate</field>
            <value>
                <elementReference>varForDate</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>OwnerId</field>
            <value>
                <elementReference>Get_Order_Management_Queue.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Subject</field>
            <value>
                <elementReference>varReviewTaskSubject</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Type</field>
            <value>
                <stringValue>Order Management</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>WhatId</field>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </inputAssignments>
        <object>Task</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Create_Billing_Issue_Case</name>
        <label>Create Billing Issue Case</label>
        <locationX>50</locationX>
        <locationY>1871</locationY>
        <inputAssignments>
            <field>AccountId</field>
            <value>
                <elementReference>$Record.AccountId</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>BTN__c</field>
            <value>
                <elementReference>Get_Service_Order_record.Billing_Number__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Billing_AccountExecutive__c</field>
            <value>
                <elementReference>$Record.Order_Point_of_Contact__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Billing_Error_Order__c</field>
            <value>
                <stringValue>Free month credits promotion</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Billing_Issue_Cause__c</field>
            <value>
                <stringValue>Adjustment Requested</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Billing_Issue__c</field>
            <value>
                <stringValue>Free month credits promotion</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>CAP_Date_of_Error_Causing_Adjustment__c</field>
            <value>
                <elementReference>$Record.Order_Completion_Date__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>CAP_What_is_the_error__c</field>
            <value>
                <stringValue>CAP request for Disruptive Offers campaign</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>ContactId</field>
            <value>
                <elementReference>$Record.BillToContactId</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Estimated_Adjustment_Amount__c</field>
            <value>
                <elementReference>$Record.Opportunity.Description</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Follow_Up_Date__c</field>
            <value>
                <elementReference>NextBusinessDay</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Opportunity__c</field>
            <value>
                <elementReference>$Record.Opportunity.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Origin</field>
            <value>
                <stringValue>Campaign Credit</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>OwnerId</field>
            <value>
                <elementReference>Get_Centralized_Services_queue.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>RecordTypeId</field>
            <value>
                <elementReference>Get_Billing_Issue_Record_Type.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Subject</field>
            <value>
                <stringValue>Free month credits promotion</stringValue>
            </value>
        </inputAssignments>
        <object>Case</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Create_Order_Management_Task_2</name>
        <label>Create Order Management Task</label>
        <locationX>842</locationX>
        <locationY>2579</locationY>
        <inputAssignments>
            <field>ActivityDate</field>
            <value>
                <elementReference>varForDate</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>OwnerId</field>
            <value>
                <elementReference>Get_Order_Management_Queue.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Subject</field>
            <value>
                <elementReference>varTaskCNPSubject</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Type</field>
            <value>
                <stringValue>Order Management</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>WhatId</field>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </inputAssignments>
        <object>Task</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordLookups>
        <name>Get_Billing_Issue_Record_Type</name>
        <label>Get Billing Issue Record Type</label>
        <locationX>50</locationX>
        <locationY>1655</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Get_Service_Order_record</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Name</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Billing Issue</stringValue>
            </value>
        </filters>
        <filters>
            <field>SobjectType</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Case</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>RecordType</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_Centralized_Services_queue</name>
        <label>Get Centralized Services queue</label>
        <locationX>50</locationX>
        <locationY>1547</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Get_Billing_Issue_Record_Type</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>DeveloperName</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Centralized_Services</stringValue>
            </value>
        </filters>
        <filters>
            <field>Type</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Queue</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Group</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_CNP_from_Acct_Team</name>
        <label>Get CNP from Acct Team</label>
        <locationX>908</locationX>
        <locationY>2255</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Is_CNP_Found</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>AccountId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.AccountId</elementReference>
            </value>
        </filters>
        <filters>
            <field>TeamMemberRole</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Circuit Network Provisioner (CNP)</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>AccountTeamMember</object>
        <sortField>CreatedDate</sortField>
        <sortOrder>Desc</sortOrder>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_Order_Management_Queue</name>
        <label>Get Order Management Queue</label>
        <locationX>1095</locationX>
        <locationY>1739</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Is_Impl_Update_Necessary</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>DeveloperName</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Order_Management_Task</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Group</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_Service_Order_record</name>
        <label>Get Service Order record</label>
        <locationX>50</locationX>
        <locationY>1763</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Create_Billing_Issue_Case</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Order__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Service_Order__c</object>
        <sortField>LastModifiedDate</sortField>
        <sortOrder>Desc</sortOrder>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordUpdates>
        <name>Update_Acct_Last_PM_Survey_Sent_date</name>
        <label>Update Acct Last PM Survey Sent date</label>
        <locationX>50</locationX>
        <locationY>1247</locationY>
        <connector>
            <targetReference>MoreConditions</targetReference>
        </connector>
        <inputAssignments>
            <field>Last_PM_Survey_Sent__c</field>
            <value>
                <elementReference>varToday</elementReference>
            </value>
        </inputAssignments>
        <inputReference>$Record.Account</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_BDT</name>
        <label>Update BDT</label>
        <locationX>968</locationX>
        <locationY>1139</locationY>
        <connector>
            <targetReference>Is_the_IS_CNP_Auto_Assignment_Condition_Met</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>BDT__c</field>
            <operator>IsNull</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <inputAssignments>
            <field>BDT__c</field>
            <value>
                <elementReference>$Record.Opportunity.BDT_Number__c</elementReference>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_CNP</name>
        <label>Update CNP</label>
        <locationX>578</locationX>
        <locationY>2579</locationY>
        <inputAssignments>
            <field>Order_Provisioner__c</field>
            <value>
                <elementReference>Get_CNP_from_Acct_Team.UserId</elementReference>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_Oppty_Rec</name>
        <label>Update Oppty Rec</label>
        <locationX>1232</locationX>
        <locationY>1355</locationY>
        <connector>
            <targetReference>Is_the_IS_CNP_Auto_Assignment_Condition_Met</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.Opportunity.Id</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>BDT_Number__c</field>
            <value>
                <elementReference>$Record.BDT__c</elementReference>
            </value>
        </inputAssignments>
        <object>Opportunity</object>
    </recordUpdates>
    <recordUpdates>
        <name>Update_with_pulling_AE_Info</name>
        <label>Update with pulling AE Info</label>
        <locationX>597</locationX>
        <locationY>431</locationY>
        <connector>
            <targetReference>Is_Risk_Case_Needed</targetReference>
        </connector>
        <inputAssignments>
            <field>Sales_Contact_Number__c</field>
            <value>
                <elementReference>$Record.Opportunity.Owner.MobilePhone</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Selling_Representative_CRIS__c</field>
            <value>
                <elementReference>$Record.Opportunity.Owner.CRIS_ID__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Selling_Representative_Email__c</field>
            <value>
                <elementReference>$Record.Opportunity.Owner.Email</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Selling_Representative_Name__c</field>
            <value>
                <elementReference>AEName</elementReference>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <start>
        <locationX>625</locationX>
        <locationY>0</locationY>
        <connector>
            <targetReference>Is_created_only</targetReference>
        </connector>
        <object>Order</object>
        <recordTriggerType>CreateAndUpdate</recordTriggerType>
        <triggerType>RecordAfterSave</triggerType>
    </start>
    <status>Active</status>
    <textTemplates>
        <name>PDMEmailBody</name>
        <isViewedAsPlainText>false</isViewedAsPlainText>
        <text>&lt;p&gt;You have been assigned to following Order:&lt;/p&gt;&lt;p&gt;&lt;strong style=&quot;font-size: 12px;&quot;&gt;Order Number:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;{!$Record.OrderNumber}&lt;/p&gt;&lt;p&gt;&lt;strong style=&quot;font-size: 12px;&quot;&gt;Order Link:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;{!CurrentOrderURL}&lt;/p&gt;&lt;p&gt;&lt;strong style=&quot;font-size: 12px;&quot;&gt;Account Name:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;{!$Record.Account_Name__c}&lt;/p&gt;&lt;p&gt;&lt;strong style=&quot;font-size: 12px;&quot;&gt;Opportunity Name:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;{!$Record.Opportunity.Name}&lt;/p&gt;&lt;p&gt;&lt;strong style=&quot;font-size: 12px;&quot;&gt;Product:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;{!$Record.Product__c}&lt;/p&gt;&lt;p&gt;&lt;strong style=&quot;font-size: 12px;&quot;&gt;Order Owner:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;{!$Record.Owners_Name__c}&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;Please refer to the link above to access the order record.&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;font-size: 12px;&quot;&gt;Thank you.&lt;/span&gt;&lt;/p&gt;</text>
    </textTemplates>
    <variables>
        <name>LockedYesOrNo</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>NewCase</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Case</objectType>
    </variables>
    <variables>
        <name>VarForUpdatingTrRec</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Order</objectType>
    </variables>
</Flow>
